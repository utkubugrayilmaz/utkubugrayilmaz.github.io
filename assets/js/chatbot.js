function getSessionId(){let n=localStorage.getItem("utku_ai_session_id");return n||(n="sess_"+Math.random().toString(36).substr(2,9),localStorage.setItem("utku_ai_session_id",n)),n}function addMessage(n,e,t=!1){const i=document.getElementById("chat-messages"),o=document.createElement("div");o.className=`message ${e}`,t?o.innerHTML=n:o.innerText=n,i.appendChild(o)}const API_BASE_URL="https://utku-ai-bot.onrender.com",styles='\n    #utku-chat-widget {\n        position: fixed;\n        bottom: 20px;\n        right: 20px;\n        z-index: 99999;\n        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n    }\n    #chat-toggle-btn {\n        background: linear-gradient(135deg, #2563eb, #1e40af);\n        color: white;\n        border: none;\n        border-radius: 50%;\n        width: 60px;\n        height: 60px;\n        cursor: pointer;\n        box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);\n        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n    #chat-toggle-btn:hover { transform: scale(1.1); }\n    #chat-toggle-btn svg { width: 30px; height: 30px; fill: white; }\n\n    #chat-container {\n        display: none;\n        width: 380px;\n        height: 600px;\n        max-height: 80vh;\n        background: #ffffff;\n        border-radius: 16px;\n        box-shadow: 0 10px 40px rgba(0,0,0,0.15);\n        flex-direction: column;\n        overflow: hidden;\n        position: absolute;\n        bottom: 80px;\n        right: 0;\n        border: 1px solid #f3f4f6;\n        animation: slideIn 0.3s ease;\n    }\n\n    @media (max-width: 480px) {\n        #chat-container {\n            position: fixed;\n            bottom: 0;\n            right: 0;\n            width: 100%;\n            height: 100%;\n            max-height: 100%;\n            border-radius: 0;\n            z-index: 100000;\n        }\n        #utku-chat-widget {\n            bottom: 20px;\n            right: 20px;\n        }\n    }\n\n    @keyframes slideIn {\n        from { opacity: 0; transform: translateY(20px); }\n        to { opacity: 1; transform: translateY(0); }\n    }\n\n    #chat-header {\n        background: linear-gradient(135deg, #2563eb, #1e40af);\n        color: white;\n        padding: 18px 20px;\n        font-weight: 600;\n        font-size: 16px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        box-shadow: 0 2px 5px rgba(0,0,0,0.1);\n    }\n\n    #chat-messages {\n        flex: 1;\n        padding: 20px;\n        overflow-y: auto;\n        background: #f8fafc;\n        display: flex;\n        flex-direction: column;\n        gap: 12px;\n        scroll-behavior: smooth;\n    }\n\n    .message {\n        max-width: 85%;\n        padding: 12px 16px;\n        border-radius: 16px;\n        font-size: 14px;\n        line-height: 1.5;\n        position: relative;\n        word-wrap: break-word;\n    }\n    .bot-msg {\n        background: white;\n        color: #1e293b;\n        align-self: flex-start;\n        border-bottom-left-radius: 4px;\n        box-shadow: 0 2px 5px rgba(0,0,0,0.05);\n        border: 1px solid #e2e8f0;\n    }\n    .user-msg {\n        background: #2563eb;\n        color: white;\n        align-self: flex-end;\n        border-bottom-right-radius: 4px;\n        box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);\n    }\n\n    #chat-input-area {\n        padding: 15px;\n        background: white;\n        border-top: 1px solid #e2e8f0;\n        display: flex;\n        gap: 10px;\n        align-items: center;\n    }\n    #chat-input {\n        flex: 1;\n        padding: 12px 15px;\n        border: 1px solid #cbd5e1;\n        border-radius: 25px;\n        outline: none;\n        font-size: 14px;\n        transition: border-color 0.2s;\n    }\n    #chat-input:focus { border-color: #2563eb; }\n    \n    #send-btn {\n        background: #2563eb;\n        color: white;\n        border: none;\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: background 0.2s;\n    }\n    #send-btn:hover { background: #1d4ed8; }\n    #send-btn:disabled { background: #94a3b8; cursor: not-allowed; }\n    \n    .typing-indicator {\n        font-size: 12px;\n        color: #64748b;\n        margin-left: 10px;\n        margin-bottom: 5px;\n        display: none;\n        font-style: italic;\n    }\n',html='\n    <div id="utku-chat-widget">\n        <div id="chat-container">\n            <div id="chat-header">\n                <div style="display:flex; align-items:center; gap:10px;">\n                    <span style="font-size:20px;">\ud83e\udd16</span>\n                    <div>\n                        <div style="line-height:1.2;">Utku AI Asistan\u0131</div>\n                        <div style="font-size:11px; opacity:0.8; font-weight:400;">Online</div>\n                    </div>\n                </div>\n                <span style="cursor:pointer; font-size:20px; padding:5px;" onclick="toggleChat()">\u2715</span>\n            </div>\n            <div id="chat-messages">\n                <div class="message bot-msg">\n                    Merhaba! \ud83d\udc4b Ben Utku\'nun dijital asistan\u0131y\u0131m. Projeleri, teknik yetkinlikleri veya \xe7al\u0131\u015fma ge\xe7mi\u015fi hakk\u0131nda bana soru sorabilirsiniz.\n                </div>\n            </div>\n            <div class="typing-indicator" id="typing">Asistan yaz\u0131yor...</div>\n            <div id="chat-input-area">\n                <input type="text" id="chat-input" placeholder="Bir soru sorun..." onkeypress="handleKeyPress(event)">\n                <button id="send-btn" onclick="sendMessage()">\n                    <svg viewBox="0 0 24 24" width="20" height="20" fill="white"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>\n                </button>\n            </div>\n        </div>\n        <button id="chat-toggle-btn" onclick="toggleChat()">\n            <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"></path></svg>\n        </button>\n    </div>\n';!function(){const n=document.createElement("style");n.innerText=styles,document.head.appendChild(n);const e=document.createElement("div");e.innerHTML=html,document.body.appendChild(e)}(),window.toggleChat=function(){const n=document.getElementById("chat-container"),e="flex"===n.style.display;n.style.display=e?"none":"flex",!e&&window.innerWidth>480&&document.getElementById("chat-input").focus()},window.handleKeyPress=function(n){"Enter"===n.key&&sendMessage()},window.sendMessage=async function(){const n=document.getElementById("chat-input"),e=document.getElementById("chat-messages"),t=document.getElementById("send-btn"),i=document.getElementById("typing"),o=n.value.trim();if(o){addMessage(o,"user-msg"),n.value="",t.disabled=!0,i.style.display="block",e.scrollTop=e.scrollHeight;try{const n=await fetch(`${API_BASE_URL}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:o,session_id:getSessionId()})}),e=await n.json();if(e.reply){addMessage(e.reply.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/\* (.*?)\n/g,"\u2022 $1<br>").replace(/\n/g,"<br>"),"bot-msg",!0)}else e.error?addMessage("\u26a0\ufe0f "+e.error,"bot-msg"):addMessage("Bir ba\u011flant\u0131 hatas\u0131 olu\u015ftu.","bot-msg")}catch(n){addMessage("Sunucuya ula\u015f\u0131lam\u0131yor.","bot-msg")}finally{t.disabled=!1,i.style.display="none",e.scrollTop=e.scrollHeight}}};